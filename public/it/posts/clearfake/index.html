<!DOCTYPE html>
<html lang="en"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        :root {
            --accent-color: #ff79c6;
        }
    </style>

    
    
    
    
    
    

    
    <title>Clearfake</title>
    <meta name="description" content="Sky&#39;s the Limit!">
    <meta name="keywords" content='malware'>

    <meta property="og:url" content="http://localhost:1313/it/posts/clearfake/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Clearfake">
    <meta property="og:description" content="Sky&#39;s the Limit!">
    <meta property="og:image" content="http://localhost:1313/images/pic.png">
    <meta property="og:image:secure_url" content="http://localhost:1313/images/pic.png">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Clearfake">
    <meta name="twitter:description" content="Sky&#39;s the Limit!">
    <meta property="twitter:domain" content="http://localhost:1313/it/posts/clearfake/">
    <meta property="twitter:url" content="http://localhost:1313/it/posts/clearfake/">
    <meta name="twitter:image" content="http://localhost:1313/images/pic.png">

    
    <link rel="canonical" href="http://localhost:1313/it/posts/clearfake/">

    
    <link rel="stylesheet" type="text/css" href="/css/normalize.min.css" media="print">

    
    <link rel="stylesheet" type="text/css" href="/css/main.min.css">

    
    <link id="dark-theme" rel="stylesheet" href="/css/dark.min.css">

    
    <script src="/js/bundle.min.893af8dd3b65bd0ffe90e7af33847bd6dc9180b8fa6d6659a212a6f4b62d3e01.js" integrity="sha256-iTr43TtlvQ/&#43;kOevM4R71tyRgLj6bWZZohKm9LYtPgE="></script>

    
    
</head>
<body>
        <script>
            
            setThemeByUserPref();
        </script><header class="header">
  <nav class="header-nav">
    
    <div class="avatar">
      <a href="http://localhost:1313/">
        <img src='/images/pic.png' alt="avatar">
      </a>
    </div>
    

    <div class="nav-title">
      <a class="nav-brand" href="http://localhost:1313/">Alessio Cassieri</a>
    </div>

    <div class="nav-links">
      
      <div class="nav-link">
        <a
          href="http://localhost:1313/projects/"
          ><span data-feather='code'></span> Projects </a>
      </div>
      
      <div class="nav-link">
        <a
          href="http://localhost:1313/posts/"
          ><span data-feather='book'></span> Posts </a>
      </div>
      
      <div class="nav-link">
        <a
          href="http://localhost:1313/experience/"
          ><span data-feather='briefcase'></span> Experience </a>
      </div>
      
      <div class="nav-link">
        <a
          href="http://localhost:1313/technologies/"
          ><span data-feather='terminal'></span> Technologies </a>
      </div>
      
      <div class="nav-link">
        <a
          href="http://localhost:1313/about/"
          ><span data-feather='link'></span> About </a>
      </div>
      

      
      <span class="nav-icons-divider"></span>

      
      <div class="nav-link language-switcher">
        
        <a href="http://localhost:1313/posts/clearfake/" class="language-link"
          >en</a
        >
        
      </div>

      
      <div class="nav-link dark-theme-toggle">
        <span class="sr-only dark-theme-toggle-screen-reader-target"></span>
        <a>
          <span class="theme-toggle-icon" data-feather="moon"></span>
        </a>
      </div>

      
      <div class="nav-link" id="hamburger-menu-toggle">
        <span class="sr-only hamburger-menu-toggle-screen-reader-target"
          >menu</span
        >
        <a>
          <span data-feather="menu"></span>
        </a>
      </div>

      
      <ul class="nav-hamburger-list visibility-hidden">
        
        <li class="nav-item">
          <a
            href="http://localhost:1313/projects/"
            ><span data-feather='code'></span> Projects </a>
        </li>
        
        <li class="nav-item">
          <a
            href="http://localhost:1313/posts/"
            ><span data-feather='book'></span> Posts </a>
        </li>
        
        <li class="nav-item">
          <a
            href="http://localhost:1313/experience/"
            ><span data-feather='briefcase'></span> Experience </a>
        </li>
        
        <li class="nav-item">
          <a
            href="http://localhost:1313/technologies/"
            ><span data-feather='terminal'></span> Technologies </a>
        </li>
        
        <li class="nav-item">
          <a
            href="http://localhost:1313/about/"
            ><span data-feather='link'></span> About </a>
        </li>
        
        <li class="nav-item dark-theme-toggle">
          <span class="sr-only dark-theme-toggle-screen-reader-target"
            >theme</span
          >
          <a>
            <span class="theme-toggle-icon" data-feather="moon"></span>
          </a>
        </li>

        
        
        <li class="nav-item">
          <a href="http://localhost:1313/posts/clearfake/" class="language-link"
            >en</a
          >
        </li>
        
      </ul>
    </div>
  </nav>
</header>
<main id="content">
    <div class="post container">
    <div class="post-header-section">
        <h1>Clearfake</h1>
        <small role="doc-subtitle"></small>
        <p class="post-date">settembre 11, 2024
        
        </p>

        <ul class="post-tags">
	 
          
           
             <li class="post-tag"><a href="http://localhost:1313/it/tags/malware">malware</a></li>
           
         
        </ul>
    </div>

    <div class="post-content">
        <h2 id="analisi-malware">Analisi Malware</h2>
<p>Questa tipologia di &ldquo;malware&rdquo; che è stato riscontrato appartiene alla categoria dei <strong>Clearfake</strong>.
La tecnica sfruttata dagli attaccanti è: un pop-up che mostra alle potenziali vittime un messaggio di errore e suggerisce di copiare e incollare uno script dannoso nel terminale di PowerShell o nella finestra di dialogo Run di Windows. Questo script, una volta eseguito, avvia il malware.</p>
<p>Nel particolare si tratta della sottocategoria &ldquo;<strong>ClickFix</strong>&rdquo; e utilizza un&rsquo;iniezione su siti web compromessi. I comandi di PowerShell scaricano ed eseguono un <strong>file MSI</strong> o uno script VBS, causando infezioni e data leaking.</p>
<p>In termini più semplici, alcuni informazioni, principalmente <em>cookies e password</em> sono stati inviati non appena il comando è stato eseguito, tramite alcuni file zip che sono stati creati nella zona della cache del Browser Google Chrome.</p>
<h3 id="comando">Comando</h3>
<p>Di seguito viene spiegato, in modo semplificato, cosa succede dopo l&rsquo;inserimento del comando nella Shell di Windows</p>
<ol>
<li><strong>Scarica da Internet</strong>: Il comando scarica delle informazioni da un sito web. Pensa a quando scarichi un file dal tuo browser, ma in questo caso, lo fa automaticamente senza che tu lo veda.</li>
<li><strong>Finge di essere un Browser</strong>: Quando scarica queste informazioni, finge di essere un browser specifico (come Google Chrome) per evitare di essere bloccato dal sito web.</li>
<li><strong>Esegue quello che scarica</strong>: Dopo aver scaricato queste informazioni, le esegue automaticamente come se fossero istruzioni per il computer. Questo è molto pericoloso perché queste istruzioni potrebbero fare qualsiasi cosa sul tuo computer.</li>
<li><strong>Pulisce la finestra del comando</strong>: Cancella quello che è stato visualizzato nella finestra dove hai eseguito il comando, così non puoi vedere cosa è successo.</li>
<li><strong>Cancella la clipboard</strong>: La clipboard è dove il computer memorizza le cose che copi, come testo o immagini. Questo comando cancella quello che c&rsquo;era nella clipboard, rendendo difficile vedere cosa è stato copiato lì prima.</li>
<li><strong>Esegue il comando di nuovo in modo nascosto</strong>: Combina tutti questi passaggi in un unico comando e poi lo esegue di nuovo in una finestra nascosta, così non puoi vedere cosa sta facendo.</li>
<li><strong>Esce</strong>: Chiude la finestra del comando.</li>
</ol>
<h4 id="perché-è-pericoloso">Perché è Pericoloso</h4>
<p>Questo comando è pericoloso perché:</p>
<ul>
<li><strong>Scarica e esegue codice</strong> da internet senza che tu sappia cosa sta facendo esattamente.</li>
<li><strong>Nasconde le sue tracce</strong> cancellando la finestra del comando e la clipboard.</li>
<li><strong>Funziona in modo nascosto</strong>, quindi non puoi vedere facilmente cosa sta succedendo.</li>
</ul>
<h3 id="funzionamento">Funzionamento</h3>
<p><img alt="clearfake funzionamento" src="/images/clearfake/clearfake_funzionamento.jpg" title="ClearFake funzionamento"></p>
<p><a href="https://www.bridewell.com/insights/blogs/detail/clearfake-campaign">link immagine</a></p>
<h3 id="catena">Catena</h3>
<p><img alt="catena" src="/images/clearfake/chain.jpg" title="Catena"></p>
<p><a href="https://www.securityopenlab.it/news/3793/errori-del-browser-no-e-un-attacco-malware.html">link immagine</a></p>
<h2 id="portatile">Portatile</h2>
<h3 id="scansione-del-portatile">Scansione del portatile</h3>
<p>Sono stati utilizzati diversi antivirus per la scansione.</p>
<h4 id="avg">AVG</h4>
<p><a href="https://www.avg.com/it-it/homepage#pc">link</a>
Dalla scansione eseguita il 20/05/2024 alle 09:24 sono stati trovati 3 elementi, tutti spostati in automaticamente quarantena.</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Nome tipo</th>
          <th style="text-align: left">File infetto</th>
          <th style="text-align: left">Azione</th>
          <th style="text-align: left">Orario</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">HTML:ClearFake-C [Trj]</td>
          <td style="text-align: left">f_0012f2</td>
          <td style="text-align: left">Quarantena</td>
          <td style="text-align: left">20/05/2024 09:24</td>
      </tr>
      <tr>
          <td style="text-align: left">HTML:ClearFake-C [Trj]</td>
          <td style="text-align: left">f_0012dd</td>
          <td style="text-align: left">Quarantena</td>
          <td style="text-align: left">20/05/2024 09:24</td>
      </tr>
      <tr>
          <td style="text-align: left">HTML:ClearFake-C [Trj]</td>
          <td style="text-align: left">f_001c80</td>
          <td style="text-align: left">Quarantena</td>
          <td style="text-align: left">20/05/2024 09:24</td>
      </tr>
  </tbody>
</table>
<p>Questi file contengono tutte le informazioni che sono state inviate agl&rsquo;aggressori, sono stati <strong>eliminati manualmente</strong> dalla quarantena, quindi eliminati completamente dal computer.</p>
<h4 id="malwarebites">MalwareBites</h4>
<p><a href="https://it.malwarebytes.com/">link</a>
Scansione completa di 7 ore e 53 minuti con il giorno 21/05/2024:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Elementi analizzati</th>
          <th style="text-align: left">Elementi rilevati</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">873,526</td>
          <td style="text-align: left">0</td>
      </tr>
  </tbody>
</table>
<p>Non presenta minacce.</p>
<h4 id="microsoft-defender">Microsoft Defender</h4>
<p>Analisi completa effettuata il 21/05/2024, ed ha riscontrato:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Rilevato</th>
          <th style="text-align: left">Stato</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">HackTool:Win32/Patcher</td>
          <td style="text-align: left">Rimosso</td>
      </tr>
  </tbody>
</table>
<p>Questo programma presenta comportamenti potenzialmente indesiderati.</p>
<h4 id="rouguekiller">RougueKiller</h4>
<p><a href="https://www.adlice.com/roguekiller/">link</a>
Scansione completa eseguita il 23/05/2024:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Elementi analizzati</th>
          <th style="text-align: left">Elementi rilevati</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">115506</td>
          <td style="text-align: left">7</td>
      </tr>
  </tbody>
</table>
<p>Che sono i seguenti:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Nome tipo</th>
          <th style="text-align: left">Azione</th>
          <th style="text-align: left">Rilevamento</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">DriverToolKit</td>
          <td style="text-align: left">Quarantena</td>
          <td style="text-align: left">PUP.DriverToolKit</td>
      </tr>
      <tr>
          <td style="text-align: left">DriverToolKit</td>
          <td style="text-align: left">Quarantena</td>
          <td style="text-align: left">PUP.DriverToolKit</td>
      </tr>
      <tr>
          <td style="text-align: left">MacPaw Inc</td>
          <td style="text-align: left">Quarantena</td>
          <td style="text-align: left">PUP.CleanMyPC</td>
      </tr>
      <tr>
          <td style="text-align: left">TSRProSetting</td>
          <td style="text-align: left">Quarantena</td>
          <td style="text-align: left">PUP.AdvancedSystemRepair</td>
      </tr>
      <tr>
          <td style="text-align: left">(x64) ForumerlT</td>
          <td style="text-align: left">Quarantena</td>
          <td style="text-align: left">PUP.Gen1</td>
      </tr>
      <tr>
          <td style="text-align: left">(x64) ConsentPrompBehaviorAdmin</td>
          <td style="text-align: left">Quarantena</td>
          <td style="text-align: left">PUM.Policies</td>
      </tr>
      <tr>
          <td style="text-align: left">(x64) {A07E5BFF-B16C-4ABA-A30F}</td>
          <td style="text-align: left">Quarantena</td>
          <td style="text-align: left">PUP.Gen0</td>
      </tr>
  </tbody>
</table>
<p>Tutti i problemi che sono stati riscontrati sono stati eliminati manualmente.</p>
<h3 id="precauzioni-aggiuntive">Precauzioni aggiuntive</h3>
<p>Si ritiene il ora il computer sia pulito, quindi non è stata eseguita una formattazione.</p>
<p>Oltre alle scansioni eseguite, è stata cancellata tutta la cronologia e tutti i cookies presenti su Google Chrome, questo perché potrebbero esserci rimasti alcuni file infetti non rilevati dagl&rsquo;antivirus.</p>
<p>Sarà necessario cambiare tutte le password dei siti salvati nel gestore di password di Google Chrome, perché potrebbero essere state inviate agl&rsquo;attaccanti. La probabilità che ci sia un accesso non autorizzato è alta. (Questa parte è stata completata successivamente insieme con il cliente.)</p>
<h2 id="blog">Blog</h2>
<p>Il blog presentava il malware subito dopo la sua apertura, per risolvere questa inconvenienza è stato fatto un controllo approfondito del <strong>file system</strong>, che presentava una coppia di file, presenti su <strong>ogni cartella e sottocartella</strong>, che rappresentavano il template del <em>ClearFake</em>, con uno script bash che cambiava i permessi di modifica, per evitare l&rsquo;eliminazione del file.</p>
<h3 id="backup-issues">Backup Issues</h3>
<p>Per risolvere il problema, l&rsquo;idea migliore era ripristinare un backup precedente all&rsquo;accaduto, ma anche tutti i <strong>backup erano stati eliminati dall&rsquo;attaccante</strong>, tranne uno del 15/05/2024.
Quest&rsquo;ultimo presentavo molti file sospetti, ma risultava essere meno restrittivo per eliminazione.</p>
<h3 id="risoluzione">Risoluzione</h3>
<p>Dopo aver ripristinato il backup sono state eseguite le seguenti operazioni:</p>
<ol>
<li><strong>Eliminazione</strong> file sospetti che non permettevano il corretto funzionamento del sito web;</li>
<li><strong>Ri-pubblicazione</strong> del blog tramite il cambiamento dei permessi nella cartella <em>public_html</em> per permettere la visualizzazione e indicizzazione;</li>
<li><strong>Pulizia plug-in</strong>: sono stati rimossi molti plug-in non utilizzati che potrebbero compromettere il sistema perché obsoleti, in particolare uno di essi si presentava in <em>duplice</em> copia, chiamato &ldquo;<strong>Wordpress Core</strong>&rdquo;;</li>
<li><strong>Aggiornamento</strong> temi e plug-in usati, sono stati anche rimossi temi inutilizzati;</li>
<li><strong>Abilitazione</strong> aggiornamenti automatici;</li>
<li><strong>Cambiamento</strong> password per accesso Wordpress.</li>
</ol>
<h3 id="conclusione">Conclusione</h3>
<p>Si presuppone che il malware sia entrato tramite un plug-in obsoleto o non aggiornato, ed abbiamo infettato tutte le cartelle con il ClearFake malware.
Ora il sito è perfettamente funzionante e più sicuro.</p>
<p>ps: per motivi di riservatezza non fornirò il link ne il nome del sito.</p>

        
    </div>

    <div class="prev-next">
        
    </div>

    
    
    <svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="scrollToTop()" title="Go to top">
        
        <path d="M177 159.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 329.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/>
    </svg>
    <script>
        let backToTopButton = document.getElementById("btt-button");

        window.onscroll = function() {
            scrollFunction()
        };

        function scrollFunction() {
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                backToTopButton.style.display = "block";
            } else {
                backToTopButton.style.display = "none";
            }
        }

        function scrollToTop() {
            window.scrollTo(0, 0);
        }
    </script>
    
    
</div>

<aside class="post-toc">
    <nav id="toc">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#analisi-malware">Analisi Malware</a>
      <ul>
        <li><a href="#comando">Comando</a></li>
        <li><a href="#funzionamento">Funzionamento</a></li>
        <li><a href="#catena">Catena</a></li>
      </ul>
    </li>
    <li><a href="#portatile">Portatile</a>
      <ul>
        <li><a href="#scansione-del-portatile">Scansione del portatile</a></li>
        <li><a href="#precauzioni-aggiuntive">Precauzioni aggiuntive</a></li>
      </ul>
    </li>
    <li><a href="#blog">Blog</a>
      <ul>
        <li><a href="#backup-issues">Backup Issues</a></li>
        <li><a href="#risoluzione">Risoluzione</a></li>
        <li><a href="#conclusione">Conclusione</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </nav>
</aside>



    

        </main><footer class="footer">
    
    

    

</footer>
</body>
</html>
